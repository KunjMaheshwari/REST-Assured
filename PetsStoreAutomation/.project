<?xml version="1.0" encoding="UTF-8"?>
<projectDescription>
	<name>PetsStoreAutomation</name>
	<comment></comment>
	<projects>
	</projects>
	<buildSpec>
		<buildCommand>
			<name>org.eclipse.jdt.core.javabuilder</name>
			<arguments>
			</arguments>
		</buildCommand>
		<buildCommand>
			<name>org.eclipse.m2e.core.maven2Builder</name>
			<arguments>
			</arguments>
		</buildCommand>
	</buildSpec>
	<natures>
		<nature>org.eclipse.jdt.core.javanature</nature>
		<nature>org.eclipse.m2e.core.maven2Nature</nature>
	</natures>
</projectDescription>










code 




private void updateExcelColumn(String columnName, String columnValue) {
    String TC_Name = dataTable.getData("General_Data", "TC_ID");

    try {
        File file = new File(System.getProperty("user.dir") + "\\TestData.xlsx");
        FileInputStream inputStream = new FileInputStream(file);
        Workbook workbook = WorkbookFactory.create(inputStream);
        Sheet sheet = workbook.getSheetAt(0);

        // ✅ Step 1: Map header names to column indices
        Row headerRow = sheet.getRow(0);
        Map<String, Integer> headerMap = new HashMap<>();
        for (Cell cell : headerRow) {
            headerMap.put(cell.getStringCellValue().trim(), cell.getColumnIndex());
        }

        // ✅ Step 2: Ensure target column exists
        if (!headerMap.containsKey(columnName)) {
            System.out.println("Column '" + columnName + "' not found in sheet!");
            inputStream.close();
            workbook.close();
            return;
        }

        int tcColumn = headerMap.get("TestCase Name");
        int targetColumn = headerMap.get(columnName);

        // ✅ Step 3: Search for TC_Name
        Row targetRow = null;
        for (int i = 1; i <= sheet.getLastRowNum(); i++) {
            Row row = sheet.getRow(i);
            if (row != null && row.getCell(tcColumn) != null &&
                row.getCell(tcColumn).getStringCellValue().equalsIgnoreCase(TC_Name)) {
                targetRow = row;
                break;
            }
        }

        // ✅ Step 4: Create new row if TC not found
        if (targetRow == null) {
            targetRow = sheet.createRow(sheet.getLastRowNum() + 1);
            targetRow.createCell(headerMap.get("S.No")).setCellValue(sheet.getLastRowNum());
            targetRow.createCell(tcColumn).setCellValue(TC_Name);
        }

        // ✅ Step 5: Update target cell
        Cell targetCell = targetRow.getCell(targetColumn, Row.MissingCellPolicy.CREATE_NULL_AS_BLANK);
        targetCell.setCellValue(columnValue);

        inputStream.close();

        // ✅ Step 6: Write back to Excel
        FileOutputStream outputStream = new FileOutputStream(file);
        workbook.write(outputStream);
        outputStream.close();
        workbook.close();

        System.out.println("✅ Updated '" + columnName + "' for TC: " + TC_Name + " with value: " + columnValue);
        common.updateLog(Status.PASS);

    } catch (Exception e) {
        System.out.println("❌ Error updating " + columnName + ": " + e.getMessage());
        common.updateLog(Status.FAIL);
    }
}
